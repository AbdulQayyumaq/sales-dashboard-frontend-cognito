"use strict";exports.id=126,exports.ids=[126],exports.modules={4126:(e,t,r)=>{r.d(t,{fromHttp:()=>m});var o=r(7529),a=r(5314),n=r(558),s=r(3292),i=r.n(s);let l=(e,t)=>{if("https:"!==e.protocol&&"169.254.170.2"!==e.hostname&&"169.254.170.23"!==e.hostname&&"[fd00:ec2::23]"!==e.hostname){if(e.hostname.includes("[")){if("[::1]"===e.hostname||"[0000:0000:0000:0000:0000:0000:0000:0001]"===e.hostname)return}else{if("localhost"===e.hostname)return;let t=e.hostname.split("."),r=e=>{let t=parseInt(e,10);return 0<=t&&t<=255};if("127"===t[0]&&r(t[1])&&r(t[2])&&r(t[3])&&4===t.length)return}throw new n.m(`URL not accepted. It must either be HTTPS or match one of the following:
  - loopback CIDR 127.0.0.0/8 or [::1/128]
  - ECS container host 169.254.170.2
  - EKS container host 169.254.170.23 or [fd00:ec2::23]`,{logger:t})}};var c=r(7056),d=r(7593),u=r(3459);async function f(e,t){let r=(0,u.O)(e.body),o=await r.transformToString();if(200===e.statusCode){let e=JSON.parse(o);if("string"!=typeof e.AccessKeyId||"string"!=typeof e.SecretAccessKey||"string"!=typeof e.Token||"string"!=typeof e.Expiration)throw new n.m("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:t});return{accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:(0,d.uj)(e.Expiration)}}if(e.statusCode>=400&&e.statusCode<500){let r={};try{r=JSON.parse(o)}catch(e){}throw Object.assign(new n.m(`Server responded with status: ${e.statusCode}`,{logger:t}),{Code:r.Code,Message:r.Message})}throw new n.m(`Server responded with status: ${e.statusCode}`,{logger:t})}let h=(e,t,r)=>async()=>{for(let o=0;o<t;++o)try{return await e()}catch(e){await new Promise(e=>setTimeout(e,r))}return await e()},m=(e={})=>{let t;e.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");let r=e.awsContainerCredentialsRelativeUri??process.env.AWS_CONTAINER_CREDENTIALS_RELATIVE_URI,s=e.awsContainerCredentialsFullUri??process.env.AWS_CONTAINER_CREDENTIALS_FULL_URI,d=e.awsContainerAuthorizationToken??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN,u=e.awsContainerAuthorizationTokenFile??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE,m=e.logger?.constructor?.name!=="NoOpLogger"&&e.logger?.warn?e.logger.warn.bind(e.logger):console.warn;if(r&&s&&(m("@aws-sdk/credential-provider-http: you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri."),m("awsContainerCredentialsFullUri will take precedence.")),d&&u&&(m("@aws-sdk/credential-provider-http: you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile."),m("awsContainerAuthorizationToken will take precedence.")),s)t=s;else if(r)t=`http://169.254.170.2${r}`;else throw new n.m(`No HTTP credential provider host provided.
Set AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.`,{logger:e.logger});let p=new URL(t);l(p,e.logger);let w=a.N.create({requestTimeout:e.timeout??1e3,connectionTimeout:e.timeout??1e3});return h(async()=>{let t=function(e){return new c.a({protocol:e.protocol,hostname:e.hostname,port:Number(e.port),path:e.pathname,query:Array.from(e.searchParams.entries()).reduce((e,[t,r])=>(e[t]=r,e),{}),fragment:e.hash})}(p);d?t.headers.Authorization=d:u&&(t.headers.Authorization=(await i().readFile(u)).toString());try{let e=await w.handle(t);return f(e.response).then(e=>(0,o.P)(e,"CREDENTIALS_HTTP","z"))}catch(t){throw new n.m(String(t),{logger:e.logger})}},e.maxRetries??3,e.timeout??1e3)}},3459:(e,t,r)=>{r.d(t,{O:()=>g});var o=r(1414),a=r(8059),n=r(2781),s=r(1392);let i=async e=>"function"==typeof Blob&&e instanceof Blob||e.constructor?.name==="Blob"?void 0!==Blob.prototype.arrayBuffer?new Uint8Array(await e.arrayBuffer()):l(e):c(e);async function l(e){let t=await new Promise((t,r)=>{let o=new FileReader;o.onloadend=()=>{if(2!==o.readyState)return r(Error("Reader aborted too early"));let e=o.result??"",a=e.indexOf(","),n=a>-1?a+1:e.length;t(e.substring(n))},o.onabort=()=>r(Error("Read aborted")),o.onerror=()=>r(o.error),o.readAsDataURL(e)}),r=(0,s.G)(t);return new Uint8Array(r)}async function c(e){let t=[],r=e.getReader(),o=!1,a=0;for(;!o;){let{done:e,value:n}=await r.read();n&&(t.push(n),a+=n.length),o=e}let n=new Uint8Array(a),s=0;for(let e of t)n.set(e,s),s+=e.length;return n}var d=r(5362),u=r(4687),f=r(7594);let h=e=>"function"==typeof ReadableStream&&(e?.constructor?.name===ReadableStream.name||e instanceof ReadableStream),m="The stream has already been transformed.",p=e=>{if(!w(e)&&!h(e)){let t=e?.__proto__?.constructor?.name||e;throw Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${t}`)}let t=!1,r=async()=>{if(t)throw Error(m);return t=!0,await i(e)},o=e=>{if("function"!=typeof e.stream)throw Error("Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.\nIf you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body");return e.stream()};return Object.assign(e,{transformToByteArray:r,transformToString:async e=>{let t=await r();if("base64"===e)return(0,d.s)(t);if("hex"===e)return(0,u.N)(t);if(void 0===e||"utf8"===e||"utf-8"===e)return(0,f.G)(t);if("function"==typeof TextDecoder)return new TextDecoder(e).decode(t);throw Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(t)throw Error(m);if(t=!0,w(e))return o(e);if(h(e))return e;throw Error(`Cannot transform payload to web stream, got ${e}`)}})},w=e=>"function"==typeof Blob&&e instanceof Blob,y="The stream has already been transformed.",g=e=>{if(!(e instanceof n.Readable))try{return p(e)}catch(r){let t=e?.__proto__?.constructor?.name||e;throw Error(`Unexpected stream implementation, expect Stream.Readable instance, got ${t}`)}let t=!1,r=async()=>{if(t)throw Error(y);return t=!0,await (0,o.C)(e)};return Object.assign(e,{transformToByteArray:r,transformToString:async e=>{let t=await r();return void 0===e||Buffer.isEncoding(e)?(0,a.g)(t.buffer,t.byteOffset,t.byteLength).toString(e):new TextDecoder(e).decode(t)},transformToWebStream:()=>{if(t)throw Error(y);if(null!==e.readableFlowing)throw Error("The stream has been consumed by other callbacks.");if("function"!=typeof n.Readable.toWeb)throw Error("Readable.toWeb() is not supported. Please ensure a polyfill is available.");return t=!0,n.Readable.toWeb(e)}})}}};