"use strict";exports.id=596,exports.ids=[596],exports.modules={7596:(e,t,r)=>{r.d(t,{Q:()=>W});var a=r(143),i=r(4388);let s=e=>{let t;let r=e.length,a=[],i=!1,s=0;for(let n=0;n<r;++n){let r=e[n];switch(r){case'"':"\\"!==t&&(i=!i);break;case",":i||(a.push(e.slice(s,n)),s=n+1)}t=r}return a.push(e.slice(s)),a.map(e=>{let t=(e=e.trim()).length;return t<2?e:('"'===e[0]&&'"'===e[t-1]&&(e=e.slice(1,t-1)),e.replace(/\\"/g,'"'))})};var n=r(7056),o=r(3459),l=r(4823),d=r(3673),h=r(7468);class u extends h.w{async serializeRequest(e,t,r){let s;let o={...t??{}},l=this.serializer,h={},u={},f=await r.endpoint(),c=a.v.of(e?.input),p=c.getSchema(),m=!1,g=new n.a({protocol:"",hostname:"",port:void 0,path:"",fragment:void 0,query:h,headers:u,body:void 0});if(f){this.updateServiceEndpoint(g,f),this.setHostPrefix(g,e,o);let t=(0,i.d)(e.traits);if(t.http){g.method=t.http[0];let[e,r]=t.http[1].split("?");"/"==g.path?g.path=e:g.path+=e,Object.assign(h,Object.fromEntries(new URLSearchParams(r??"")))}}for(let[e,t]of c.structIterator()){let r=t.getMergedTraits()??{},a=o[e];if(null!=a){if(r.httpPayload)t.isStreaming()?t.isStructSchema()?o[e]&&(s=await this.serializeEventStream({eventStream:o[e],requestSchema:c})):s=a:(l.write(t,a),s=l.flush()),delete o[e];else if(r.httpLabel){l.write(t,a);let r=l.flush();g.path.includes(`{${e}+}`)?g.path=g.path.replace(`{${e}+}`,r.split("/").map(d.j).join("/")):g.path.includes(`{${e}}`)&&(g.path=g.path.replace(`{${e}}`,(0,d.j)(r))),delete o[e]}else if(r.httpHeader)l.write(t,a),u[r.httpHeader.toLowerCase()]=String(l.flush()),delete o[e];else if("string"==typeof r.httpPrefixHeaders){for(let[e,i]of Object.entries(a)){let a=r.httpPrefixHeaders+e;l.write([t.getValueSchema(),{httpHeader:a}],i),u[a.toLowerCase()]=l.flush()}delete o[e]}else r.httpQuery||r.httpQueryParams?(this.serializeQuery(t,a,h),delete o[e]):m=!0}}return m&&o&&(l.write(p,o),s=l.flush()),g.headers=u,g.query=h,g.body=s,g}serializeQuery(e,t,r){let a=this.serializer,i=e.getMergedTraits();if(i.httpQueryParams){for(let[a,s]of Object.entries(t))if(!(a in r)){let t=e.getValueSchema();Object.assign(t.getMergedTraits(),{...i,httpQuery:a,httpQueryParams:void 0}),this.serializeQuery(t,s,r)}return}if(e.isListSchema()){let s=!!e.getMergedTraits().sparse,n=[];for(let r of t){a.write([e.getValueSchema(),i],r);let t=a.flush();(s||void 0!==t)&&n.push(t)}r[i.httpQuery]=n}else a.write([e,i],t),r[i.httpQuery]=a.flush()}async deserializeResponse(e,t,r){let i=this.deserializer,s=a.v.of(e.output),n={};if(r.statusCode>=300){let a=await (0,l.W)(r.body,t);throw a.byteLength>0&&Object.assign(n,await i.read(15,a)),await this.handleError(e,t,r,n,this.deserializeMetadata(r)),Error("@smithy/core/protocols - HTTP Protocol error handler failed to throw.")}for(let e in r.headers){let t=r.headers[e];delete r.headers[e],r.headers[e.toLowerCase()]=t}let o=await this.deserializeHttpMessage(s,t,r,n);if(o.length){let e=await (0,l.W)(r.body,t);if(e.byteLength>0){let t=await i.read(s,e);for(let e of o)n[e]=t[e]}}return n.$metadata=this.deserializeMetadata(r),n}async deserializeHttpMessage(e,t,r,i,n){let d;d=i instanceof Set?n:i;let h=this.deserializer,u=a.v.of(e),f=[];for(let[e,a]of u.structIterator()){let i=a.getMemberTraits();if(i.httpPayload){if(a.isStreaming())a.isStructSchema()?d[e]=await this.deserializeEventStream({response:r,responseSchema:u}):d[e]=(0,o.O)(r.body);else if(r.body){let i=await (0,l.W)(r.body,t);i.byteLength>0&&(d[e]=await h.read(a,i))}}else if(i.httpHeader){let t=String(i.httpHeader).toLowerCase(),n=r.headers[t];if(null!=n){if(a.isListSchema()){let r=a.getValueSchema();r.getMergedTraits().httpHeader=t;let i=[];for(let e of r.isTimestampSchema()&&4===r.getSchema()?function(e,t,r){if(r<=0||!Number.isInteger(r))throw Error("Invalid number of delimiters ("+r+") for splitEvery.");let a=e.split(t);if(1===r)return a;let i=[],s="";for(let e=0;e<a.length;e++)""===s?s=a[e]:s+=t+a[e],(e+1)%r==0&&(i.push(s),s="");return""!==s&&i.push(s),i}(n,",",2):s(n))i.push(await h.read(r,e.trim()));d[e]=i}else d[e]=await h.read(a,n)}}else if(void 0!==i.httpPrefixHeaders){for(let[t,s]of(d[e]={},Object.entries(r.headers)))if(t.startsWith(i.httpPrefixHeaders)){let r=a.getValueSchema();r.getMergedTraits().httpHeader=t,d[e][t.slice(i.httpPrefixHeaders.length)]=await h.read(r,s)}}else i.httpResponseCode?d[e]=r.statusCode:f.push(e)}return f}}var f=r(7593),c=r(2418),p=r(5362),m=r(6428),g=r(3323);class b extends m.l{constructor(e){super(),this.stringBuffer="",this.settings=e}write(e,t){let r=a.v.of(e);switch(typeof t){case"object":if(null===t){this.stringBuffer="null";return}if(r.isTimestampSchema()){if(!(t instanceof Date))throw Error(`@smithy/core/protocols - received non-Date value ${t} when schema expected Date in ${r.getName(!0)}`);switch((0,g.d)(r,this.settings)){case 5:this.stringBuffer=t.toISOString().replace(".000Z","Z");break;case 6:this.stringBuffer=(0,f._w)(t);break;case 7:this.stringBuffer=String(t.getTime()/1e3);break;default:console.warn("Missing timestamp format, using epoch seconds",t),this.stringBuffer=String(t.getTime()/1e3)}return}if(r.isBlobSchema()&&"byteLength"in t){this.stringBuffer=(this.serdeContext?.base64Encoder??p.s)(t);return}if(r.isListSchema()&&Array.isArray(t)){let e="";for(let a of t){var i;this.write([r.getValueSchema(),r.getMergedTraits()],a);let t=this.flush();""!==e&&(e+=", "),e+=r.getValueSchema().isTimestampSchema()?t:(((i=t).includes(",")||i.includes('"'))&&(i=`"${i.replace(/"/g,'\\"')}"`),i)}this.stringBuffer=e;return}this.stringBuffer=JSON.stringify(t,null,2);break;case"string":let s=r.getMergedTraits().mediaType,n=t;if(s&&(("application/json"===s||s.endsWith("+json"))&&(n=c.Q.from(n)),r.getMergedTraits().httpHeader)){this.stringBuffer=(this.serdeContext?.base64Encoder??p.s)(n.toString());return}this.stringBuffer=t;break;default:this.stringBuffer=String(t)}}flush(){let e=this.stringBuffer;return this.stringBuffer="",e}}class y{constructor(e,t,r=new b(t)){this.codecSerializer=e,this.stringSerializer=r}setSerdeContext(e){this.codecSerializer.setSerdeContext(e),this.stringSerializer.setSerdeContext(e)}write(e,t){let r=a.v.of(e),i=r.getMergedTraits();if(i.httpHeader||i.httpLabel||i.httpQuery){this.stringSerializer.write(r,t),this.buffer=this.stringSerializer.flush();return}return this.codecSerializer.write(r,t)}flush(){if(void 0!==this.buffer){let e=this.buffer;return this.buffer=void 0,e}return this.codecSerializer.flush()}}var w=r(7594),S=r(2695);let T="(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun)(?:[ne|u?r]?s?day)?",x="(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)",v="(\\d?\\d):(\\d{2}):(\\d{2})(?:\\.(\\d+))?",C="(\\d?\\d)",E="(\\d{4})",z=new RegExp(/^(\d{4})-(\d\d)-(\d\d)[tT](\d\d):(\d\d):(\d\d)(\.(\d+))?(([-+]\d\d:\d\d)|[zZ])$/),$=RegExp(`^${T}, ${C} ${x} ${E} ${v} GMT$`),B=RegExp(`^${T}, ${C}-${x}-(\\d\\d) ${v} GMT$`),M=RegExp(`^${T} ${x} ( [1-9]|\\d\\d) ${v} ${E}$`),N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],D=e=>{if(null==e)return;let t=NaN;if("number"==typeof e)t=e;else if("string"==typeof e){if(!/^-?\d*\.?\d+$/.test(e))throw TypeError("parseEpochTimestamp - numeric string invalid.");t=Number.parseFloat(e)}else"object"==typeof e&&1===e.tag&&(t=e.value);if(isNaN(t)||Math.abs(t)===1/0)throw TypeError("Epoch timestamps must be valid finite numbers.");return new Date(Math.round(1e3*t))},R=e=>{if(null==e)return;if("string"!=typeof e)throw TypeError("RFC3339 timestamps must be strings");let t=z.exec(e);if(!t)throw TypeError(`Invalid RFC3339 timestamp format ${e}`);let[,r,a,i,s,n,o,,l,d]=t;H(a,1,12),H(i,1,31),H(s,0,23),H(n,0,59),H(o,0,60);let h=new Date(Date.UTC(Number(r),Number(a)-1,Number(i),Number(s),Number(n),Number(o),Number(l)?Math.round(1e3*parseFloat(`0.${l}`)):0));if(h.setUTCFullYear(Number(r)),"Z"!=d.toUpperCase()){let[,e,t,r]=/([+-])(\d\d):(\d\d)/.exec(d)||[void 0,"+",0,0];h.setTime(h.getTime()+("-"===e?1:-1)*(36e5*Number(t)+6e4*Number(r)))}return h},j=e=>{let t,r,a,i,s,n,o,l;if(null!=e){if("string"!=typeof e)throw TypeError("RFC7231 timestamps must be strings.");if((l=$.exec(e))?[,t,r,a,i,s,n,o]=l:(l=B.exec(e))?([,t,r,a,i,s,n,o]=l,a=(Number(a)+1900).toString()):(l=M.exec(e))&&([,r,t,i,s,n,o,a]=l),a&&n){let e=Date.UTC(Number(a),N.indexOf(r),Number(t),Number(i),Number(s),Number(n),o?Math.round(1e3*parseFloat(`0.${o}`)):0);H(t,1,31),H(i,0,23),H(s,0,59),H(n,0,60);let l=new Date(e);return l.setUTCFullYear(Number(a)),l}throw TypeError(`Invalid RFC7231 date-time value ${e}.`)}};function H(e,t,r){let a=Number(e);if(a<t||a>r)throw Error(`Value ${a} out of range [${t}, ${r}]`)}var O=r(6305),P=r(1392);class L extends m.l{constructor(e){super(),this.settings=e}read(e,t){let r=a.v.of(e);if(r.isListSchema())return s(t).map(e=>this.read(r.getValueSchema(),e));if(r.isBlobSchema())return(this.serdeContext?.base64Decoder??P.G)(t);if(r.isTimestampSchema())switch((0,g.d)(r,this.settings)){case 5:return R(t);case 6:return j(t);case 7:return D(t);default:return console.warn("Missing timestamp format, parsing value with Date constructor:",t),new Date(t)}if(r.isStringSchema()){let e=r.getMergedTraits().mediaType,a=t;if(e)return r.getMergedTraits().httpHeader&&(a=this.base64ToUtf8(a)),("application/json"===e||e.endsWith("+json"))&&(a=c.Q.from(a)),a}return r.isNumericSchema()?Number(t):r.isBigIntegerSchema()?BigInt(t):r.isBigDecimalSchema()?new O.G(t,"bigDecimal"):r.isBooleanSchema()?"true"===String(t).toLowerCase():t}base64ToUtf8(e){return(this.serdeContext?.utf8Encoder??w.G)((this.serdeContext?.base64Decoder??P.G)(e))}}class U extends m.l{constructor(e,t){super(),this.codecDeserializer=e,this.stringDeserializer=new L(t)}setSerdeContext(e){this.stringDeserializer.setSerdeContext(e),this.codecDeserializer.setSerdeContext(e),this.serdeContext=e}read(e,t){let r=a.v.of(e),i=r.getMergedTraits(),s=this.serdeContext?.utf8Encoder??w.G;if(i.httpHeader||i.httpResponseCode)return this.stringDeserializer.read(r,s(t));if(i.httpPayload){if(r.isBlobSchema()){let e=this.serdeContext?.utf8Decoder??S.$;return"string"==typeof t?e(t):t}if(r.isStringSchema())return"byteLength"in t?s(t):t}return this.codecDeserializer.read(r,t)}}var F=r(2770),I=r(8304),Q=r(3024),A=r(4060);class W extends u{constructor({defaultNamespace:e}){super({defaultNamespace:e}),this.mixin=new I._;let t={timestampFormat:{useTrait:!0,default:7},httpBindings:!0,jsonName:!0};this.codec=new Q.a(t),this.serializer=new y(this.codec.createSerializer(),t),this.deserializer=new U(this.codec.createDeserializer(),t)}getShapeId(){return"aws.protocols#restJson1"}getPayloadCodec(){return this.codec}setSerdeContext(e){this.codec.setSerdeContext(e),super.setSerdeContext(e)}async serializeRequest(e,t,r){let i=await super.serializeRequest(e,t,r),s=a.v.of(e.input);if(!i.headers["content-type"]){let e=this.mixin.resolveRestContentType(this.getDefaultContentType(),s);e&&(i.headers["content-type"]=e)}return i.headers["content-type"]&&!i.body&&(i.body="{}"),i}async handleError(e,t,r,i,s){let n=(0,A.mJ)(r,i)??"Unknown",{errorSchema:o,errorMetadata:l}=await this.mixin.getErrorSchemaOrThrowBaseException(n,this.options.defaultNamespace,r,i,s),d=a.v.of(o),h=i.message??i.Message??"Unknown",u=new(F.P.for(o[1]).getErrorCtor(o)??Error)(h);await this.deserializeHttpMessage(o,t,r,i);let f={};for(let[e,t]of d.structIterator()){let r=t.getMergedTraits().jsonName??e;f[e]=this.codec.createDeserializer().readObject(t,i[r])}throw Object.assign(u,l,{$fault:d.getMergedTraits().error,message:h},f)}getDefaultContentType(){return"application/json"}}},3673:(e,t,r)=>{r.d(t,{j:()=>a});function a(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}},3459:(e,t,r)=>{r.d(t,{O:()=>y});var a=r(1414),i=r(8059),s=r(2781),n=r(1392);let o=async e=>"function"==typeof Blob&&e instanceof Blob||e.constructor?.name==="Blob"?void 0!==Blob.prototype.arrayBuffer?new Uint8Array(await e.arrayBuffer()):l(e):d(e);async function l(e){let t=await new Promise((t,r)=>{let a=new FileReader;a.onloadend=()=>{if(2!==a.readyState)return r(Error("Reader aborted too early"));let e=a.result??"",i=e.indexOf(","),s=i>-1?i+1:e.length;t(e.substring(s))},a.onabort=()=>r(Error("Read aborted")),a.onerror=()=>r(a.error),a.readAsDataURL(e)}),r=(0,n.G)(t);return new Uint8Array(r)}async function d(e){let t=[],r=e.getReader(),a=!1,i=0;for(;!a;){let{done:e,value:s}=await r.read();s&&(t.push(s),i+=s.length),a=e}let s=new Uint8Array(i),n=0;for(let e of t)s.set(e,n),n+=e.length;return s}var h=r(5362),u=r(4687),f=r(7594);let c=e=>"function"==typeof ReadableStream&&(e?.constructor?.name===ReadableStream.name||e instanceof ReadableStream),p="The stream has already been transformed.",m=e=>{if(!g(e)&&!c(e)){let t=e?.__proto__?.constructor?.name||e;throw Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${t}`)}let t=!1,r=async()=>{if(t)throw Error(p);return t=!0,await o(e)},a=e=>{if("function"!=typeof e.stream)throw Error("Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.\nIf you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body");return e.stream()};return Object.assign(e,{transformToByteArray:r,transformToString:async e=>{let t=await r();if("base64"===e)return(0,h.s)(t);if("hex"===e)return(0,u.N)(t);if(void 0===e||"utf8"===e||"utf-8"===e)return(0,f.G)(t);if("function"==typeof TextDecoder)return new TextDecoder(e).decode(t);throw Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(t)throw Error(p);if(t=!0,g(e))return a(e);if(c(e))return e;throw Error(`Cannot transform payload to web stream, got ${e}`)}})},g=e=>"function"==typeof Blob&&e instanceof Blob,b="The stream has already been transformed.",y=e=>{if(!(e instanceof s.Readable))try{return m(e)}catch(r){let t=e?.__proto__?.constructor?.name||e;throw Error(`Unexpected stream implementation, expect Stream.Readable instance, got ${t}`)}let t=!1,r=async()=>{if(t)throw Error(b);return t=!0,await (0,a.C)(e)};return Object.assign(e,{transformToByteArray:r,transformToString:async e=>{let t=await r();return void 0===e||Buffer.isEncoding(e)?(0,i.g)(t.buffer,t.byteOffset,t.byteLength).toString(e):new TextDecoder(e).decode(t)},transformToWebStream:()=>{if(t)throw Error(b);if(null!==e.readableFlowing)throw Error("The stream has been consumed by other callbacks.");if("function"!=typeof s.Readable.toWeb)throw Error("Readable.toWeb() is not supported. Please ensure a polyfill is available.");return t=!0,s.Readable.toWeb(e)}})}}};